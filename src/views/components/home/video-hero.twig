{#
| Variable                       | Type     | Description                                                                  |
|--------------------------------|----------|------------------------------------------------------------------------------|
| component                      | object   | Contains merchant settings for fields from twilight.json `component` section |
| component.videos[].type        | string   | Video type: 'upload', 'youtube', 'vimeo', 'url'                            |
| component.videos[].source      | string   | Video source URL or file path                                               |
| component.videos[].poster      | string   | Poster image URL for video                                                  |
| component.videos[].title       | ?string  | Video title                                                                 |
| component.videos[].description | ?string  | Video description                                                           |
| component.videos[].autoplay    | ?boolean | Auto play video (default: false)                                           |
| component.videos[].muted       | ?boolean | Mute video (default: true)                                                 |
| component.videos[].loop        | ?boolean | Loop video (default: true)                                                 |
| component.videos               | object[] | List of videos                                                              |
| component.height               | ?string  | Custom height (default: auto)                                              |
| component.overlay_opacity      | ?string  | Overlay opacity (default: 60)                                              |
| position                       | int      | Sorting number start from zero                                             |
#}

<section class="s-block s-block--video-hero s-block--full-bg wide-placeholder">
    <div class="video-hero-container relative overflow-hidden rounded-lg"
         style="min-height: {{ component.height|default('500px') }};">
        
        {% if component.videos and component.videos|length > 0 %}
            {% if component.videos|length == 1 %}
                {# Single Video #}
                {% set video = component.videos[0] %}
                <div class="video-hero-item w-full h-full relative">
                    {{ _self.render_video(video, component, position) }}
                    {{ _self.render_content(video) }}
                </div>
            {% else %}
                {# Multiple Videos with Slider #}
                <salla-slider 
                    id="video-hero-slider-{{ position }}"
                    auto-play="{{ component.auto_slide|default('true') }}"
                    slider-config='{
                        "lazy": "true",
                        "autoplay": {
                            "delay": {{ component.slide_delay|default('5000') }},
                            "disableOnInteraction": false
                        },
                        "effect": "fade",
                        "fadeEffect": {
                            "crossFade": true
                        }
                    }'
                    type="fullwidth">
                    <div slot="items">
                        {% for video in component.videos %}
                            <div class="swiper-slide video-hero-item w-full relative">
                                {{ _self.render_video(video, component, loop.index0) }}
                                {{ _self.render_content(video) }}
                            </div>
                        {% endfor %}
                    </div>
                </salla-slider>
            {% endif %}
        {% else %}
            {# Fallback when no videos #}
            <div class="video-hero-fallback flex items-center justify-center h-96 bg-gray-200 text-gray-500">
                <div class="text-center">
                    <i class="sicon-video text-4xl mb-4"></i>
                    <p>{{ trans('pages.home.video_hero.no_videos') }}</p>
                </div>
            </div>
        {% endif %}
    </div>
</section>

{# Video Rendering Macro #}
{% macro render_video(video, component, index) %}
    {% set overlay_opacity = component.overlay_opacity|default('60') %}
    
    <div class="video-hero-background absolute inset-0 w-full h-full">
        {% if video.type == 'youtube' %}
            {# YouTube Video #}
            <div class="youtube-video-container w-full h-full relative">
                {% if video.poster %}
                    <img src="{{ video.poster }}" 
                         alt="{{ video.title|default('Video') }}"
                         class="video-poster absolute inset-0 w-full h-full object-cover"
                         loading="lazy">
                {% endif %}
                <iframe class="youtube-iframe absolute inset-0 w-full h-full"
                        data-src="https://www.youtube.com/embed/{{ video.source }}?autoplay={{ video.autoplay|default('0') }}&mute={{ video.muted|default('1') }}&loop={{ video.loop|default('1') }}&controls=0&showinfo=0&rel=0&modestbranding=1&playsinline=1"
                        frameborder="0"
                        allow="autoplay; encrypted-media"
                        allowfullscreen
                        loading="lazy"></iframe>
            </div>
            
        {% elseif video.type == 'vimeo' %}
            {# Vimeo Video #}
            <div class="vimeo-video-container w-full h-full relative">
                {% if video.poster %}
                    <img src="{{ video.poster }}" 
                         alt="{{ video.title|default('Video') }}"
                         class="video-poster absolute inset-0 w-full h-full object-cover"
                         loading="lazy">
                {% endif %}
                <iframe class="vimeo-iframe absolute inset-0 w-full h-full"
                        data-src="https://player.vimeo.com/video/{{ video.source }}?autoplay={{ video.autoplay|default('0') }}&muted={{ video.muted|default('1') }}&loop={{ video.loop|default('1') }}&controls=0&title=0&byline=0&portrait=0&background=1"
                        frameborder="0"
                        allow="autoplay; fullscreen"
                        allowfullscreen
                        loading="lazy"></iframe>
            </div>
            
        {% else %}
            {# Direct Video (MP4, WebM, etc.) #}
            <video class="video-element absolute inset-0 w-full h-full object-cover"
                   {% if video.poster %}poster="{{ video.poster }}"{% endif %}
                   {% if video.autoplay|default(false) %}autoplay{% endif %}
                   {% if video.muted|default(true) %}muted{% endif %}
                   {% if video.loop|default(true) %}loop{% endif %}
                   playsinline
                   preload="metadata"
                   data-video-index="{{ index }}">
                <source src="{{ video.source }}" type="video/mp4">
                <source src="{{ video.source|replace({'.mp4': '.webm'}) }}" type="video/webm">
                {% if video.poster %}
                    <img src="{{ video.poster }}" 
                         alt="{{ video.title|default('Video') }}"
                         class="w-full h-full object-cover">
                {% endif %}
            </video>
        {% endif %}
        
        {# Overlay #}
        <div class="video-overlay absolute inset-0 bg-black/{{ overlay_opacity }} pointer-events-none"></div>
    </div>
{% endmacro %}

{# Content Rendering Macro #}
{% macro render_content(video) %}
    {% if video.title or video.description %}
        <div class="video-hero-content absolute inset-0 flex items-center justify-center z-10">
            <div class="container px-4">
                <div class="text-center text-white max-w-4xl mx-auto">
                    {% if video.title %}
                        <h1 class="video-hero-title text-3xl md:text-4xl lg:text-5xl font-bold mb-4 leading-tight"
                            data-swiper-parallax="-500">
                            {{ video.title }}
                        </h1>
                    {% endif %}
                    
                    {% if video.description %}
                        <p class="video-hero-description text-lg md:text-xl opacity-90 max-w-2xl mx-auto leading-relaxed"
                           data-swiper-parallax="-300">
                            {{ video.description }}
                        </p>
                    {% endif %}
                    
                    {% if video.button_text and video.button_url %}
                        <div class="video-hero-cta mt-8" data-swiper-parallax="-200">
                            <a href="{{ video.button_url }}" 
                               class="btn btn-primary btn-lg px-8 py-3 rounded-full hover:scale-105 transition-transform duration-300">
                                {{ video.button_text }}
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endif %}
{% endmacro %}